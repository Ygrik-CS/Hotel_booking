# Hotel Booking System - Functional Programming + REST API

–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª–µ–π, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI, SQLAlchemy –∏ SQLite.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **REST API** –Ω–∞ FastAPI —Å —Ä–æ—É—Ç–µ—Ä–∞–º–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏
- **SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Å CASCADE delete –∏ foreign keys
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å, —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ä–µ–∫—É—Ä—Å–∏—è, –º–µ–º–æ–∏–∑–∞—Ü–∏—è
- **JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **CORS middleware** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Frontend –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∫–æ—Ä–∑–∏–Ω—ã
- **–í—Å–µ 8 –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
server/
‚îú‚îÄ‚îÄ app/                  # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ core/                 # –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —è–¥—Ä–æ
‚îÇ   ‚îú‚îÄ‚îÄ domain.py         # –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ transforms.py     # –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, HOF
‚îÇ   ‚îú‚îÄ‚îÄ recursion.py      # –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ memo.py           # –ú–µ–º–æ–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ ftypes.py         # Maybe/Either –º–æ–Ω–∞–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ lazy.py           # –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ frp.py            # Event Bus (FRP)
‚îÇ   ‚îú‚îÄ‚îÄ compose.py        # –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ service.py        # –°–µ—Ä–≤–∏—Å—ã-—Ñ–∞—Å–∞–¥—ã
‚îú‚îÄ‚îÄ models/               # SQLAlchemy ORM –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ controllers/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ routers/              # REST API endpoints
‚îú‚îÄ‚îÄ middleware/           # JWT, CORS
‚îú‚îÄ‚îÄ database/             # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ static/               # Frontend (HTML/CSS/JS)
‚îî‚îÄ‚îÄ tests/                # Pytest —Ç–µ—Å—Ç—ã
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- pip

### –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

1. **–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
```powershell
python -m venv .venv
.venv\Scripts\activate
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```powershell
pip install -r requirements.txt
```

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
```powershell
copy .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SECRET_KEY
```

4. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ**
```powershell
python -m database.seed_generator
```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä**
```powershell
cd server
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **Frontend**: http://localhost:8000/static/html/index.html

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /auth/login` - –í—Ö–æ–¥
- `GET /auth/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

#### –û—Ç–µ–ª–∏
- `GET /hotels` - –°–ø–∏—Å–æ–∫ –æ—Ç–µ–ª–µ–π
- `GET /hotels/{id}` - –î–µ—Ç–∞–ª–∏ –æ—Ç–µ–ª—è

#### –ü–æ–∏—Å–∫
- `POST /search` - –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ—Ç–µ–ª–µ–π

#### –ö–æ—Ä–∑–∏–Ω–∞
- `GET /cart` - –ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
- `POST /cart/add` - –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
- `DELETE /cart/{id}` - –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã

#### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `POST /bookings` - –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `GET /bookings/{id}` - –î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `POST /bookings/{id}/cancel` - –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –û–ø–ª–∞—Ç–∞
- `POST /payments` - –°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂
- `GET /payments/{id}` - –î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```powershell
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=. --cov-report=html

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ª–∞–±–∞
pytest tests/test_functional.py -v
pytest tests/test_recursion.py -v
pytest tests/test_memo.py -v
```

## üìñ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –õ–∞–±–∞ 1: –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, HOF, –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
- –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ dataclass —Å `@dataclass(frozen=True)`
- HOF: `apply_to_all`, `filter_items`, `fold_left`
- –ö–æ–º–ø–æ–∑–∏—Ü–∏—è: `compose`
- –î–æ–º–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: `filter_hotels_by_city`, `calculate_total_price`

### ‚úÖ –õ–∞–±–∞ 2: –†–µ–∫—É—Ä—Å–∏—è –∏ –∑–∞–º—ã–∫–∞–Ω–∏—è
- `split_date_range` - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞—Ç
- `flatten_tuple` - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
- `filter_tree` - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- `max_depth` - –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏

### ‚úÖ –õ–∞–±–∞ 3: –ú–µ–º–æ–∏–∑–∞—Ü–∏—è
- `@lru_cache` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
- –ö–∞—Å—Ç–æ–º–Ω—ã–π `@memoize` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
- `fibonacci_memo` - –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Fibonacci
- `calculate_date_range_price` - –∫–µ—à —Ü–µ–Ω

### ‚úÖ –õ–∞–±–∞ 4: Maybe/Either –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- Maybe monad —Å –º–µ—Ç–æ–¥–∞–º–∏ `map`, `flat_map`, `get_or_else`
- Either monad –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –í–∞–ª–∏–¥–∞—Ü–∏—è: `validate_positive`, `validate_email`

### ‚úÖ –õ–∞–±–∞ 5: –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: `lazy_search_offers`
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏: `generate_calendar`
- `yield` –¥–ª—è –ª–µ–Ω–∏–≤—ã—Ö –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤

### ‚úÖ –õ–∞–±–∞ 6: FRP (Functional Reactive Programming)
- EventBus - —à–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π
- –°–æ–±—ã—Ç–∏—è: SEARCH, HOLD, BOOKED, CANCELLED
- –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

### ‚úÖ –õ–∞–±–∞ 7: –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∏ —Ñ–∞—Å–∞–¥—ã
- SearchService - —Ñ–∞—Å–∞–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞
- QuoteService - —Ñ–∞—Å–∞–¥ –¥–ª—è –∫–≤–æ—Ç–∞—Ü–∏–∏
- BookingService - —Ñ–∞—Å–∞–¥ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `compose`, `pipe` - –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π

### ‚úÖ –õ–∞–±–∞ 8: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- `async/await` –≤ FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

```
Client (Browser)
    ‚Üì
Static Files (HTML/CSS/JS)
    ‚Üì
REST API Layer (FastAPI Routers)
    ‚Üì
Controllers (Business Logic)
    ‚Üì
Services (Functional Facades)
    ‚Üì
Core (Pure Functions, Immutable Domain)
    ‚Üì
Models (SQLAlchemy ORM)
    ‚Üì
Database (SQLite)
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

- **Separation of Concerns** - –∫–∞–∂–¥—ã–π —Å–ª–æ–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å
- **SOLID** - –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã —Å–ª–µ–¥—É—é—Ç Single Responsibility Principle
- **Functional Core, Imperative Shell** - —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ core, –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –≤ controllers
- **Dependency Injection** - —á–µ—Ä–µ–∑ FastAPI Depends

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å bcrypt
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- SQLite foreign keys –≤–∫–ª—é—á–µ–Ω—ã

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

12 —Ç–∞–±–ª–∏—Ü —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CASCADE:
- users, hotels, room_types, rate_plans
- prices, availabilities, guests, cart_items
- bookings, payments, events, rules

## üé® Frontend

- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –ü–æ–∏—Å–∫ –æ—Ç–µ–ª–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å REST API

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üë• –ê–≤—Ç–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é.
